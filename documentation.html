<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OIS LabPro Documentation</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        h1, h2, h3, h4 {
            color: #2563eb;
        }
        h1 {
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 2px solid #e5e7eb;
        }
        .logo {
            display: block;
            margin: 20px auto;
            max-width: 200px;
        }
        pre {
            background-color: #f6f8fa;
            padding: 16px;
            border-radius: 6px;
            overflow-x: auto;
        }
        code {
            font-family: 'Courier New', Courier, monospace;
            background-color: #f6f8fa;
            padding: 2px 4px;
            border-radius: 3px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            padding: 10px;
            border: 1px solid #e5e7eb;
            text-align: left;
        }
        th {
            background-color: #f3f4f6;
        }
        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: space-between;
        }
        .feature-box {
            flex: 1 1 300px;
            background-color: #f9fafb;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #e5e7eb;
            margin-bottom: 20px;
        }
        .section {
            margin-bottom: 40px;
        }
        .alert {
            background-color: #fef2f2;
            color: #b91c1c;
            padding: 10px;
            border-radius: 5px;
            border-left: 4px solid #b91c1c;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <header>
        <h1>OIS LabPro - AI-Powered Lab Management Platform</h1>
        <img src="generated-icon.png" alt="OIS LabPro Logo" class="logo">
    </header>

    <div class="section">
        <h2>Overview</h2>
        <p>OIS LabPro is a comprehensive laboratory management platform built with modern web technologies. It offers test booking, tracking, and smart reporting capabilities enhanced with AI-powered insights.</p>
    </div>

    <div class="section">
        <h2>Features</h2>
        <div class="container">
            <div class="feature-box">
                <h3>User Authentication</h3>
                <p>Secure login and registration system with role-based access control</p>
            </div>
            <div class="feature-box">
                <h3>Test Management</h3>
                <p>Browse and book diagnostic tests with detailed information</p>
            </div>
            <div class="feature-box">
                <h3>Sample Collection Options</h3>
                <p>Choose between lab visit or home collection for each test</p>
            </div>
            <div class="feature-box">
                <h3>Real-time Status Tracking</h3>
                <p>Monitor the progress of your tests through each stage</p>
            </div>
            <div class="feature-box">
                <h3>AI-Powered Insights</h3>
                <p>Get intelligent analysis of your test results using OpenAI integration</p>
            </div>
            <div class="feature-box">
                <h3>Secure Report Access</h3>
                <p>View and download test reports with personalized recommendations</p>
            </div>
            <div class="feature-box">
                <h3>Administrative Dashboard</h3>
                <p>Manage tests, bookings, and generate reports with admin tools</p>
            </div>
        </div>
    </div>

    <div class="section">
        <h2>Technology Stack</h2>
        <ul>
            <li><strong>Frontend:</strong> React.js with TypeScript</li>
            <li><strong>Backend:</strong> Node.js with Express</li>
            <li><strong>Database:</strong> PostgreSQL with Drizzle ORM</li>
            <li><strong>Authentication:</strong> Passport.js with local strategy</li>
            <li><strong>AI Integration:</strong> OpenAI API for test result analysis</li>
            <li><strong>Styling:</strong> Tailwind CSS with shadcn/ui components</li>
        </ul>
    </div>

    <div class="section">
        <h2>Deployment Guide</h2>

        <h3>Prerequisites</h3>
        <ul>
            <li>Node.js (v20+ recommended)</li>
            <li>PostgreSQL database server</li>
            <li>OpenAI API key (for AI insights feature)</li>
            <li>Git</li>
        </ul>

        <h3>Step 1: Get the Code</h3>
        <pre><code># Clone the repository
git clone &lt;repository-url&gt; ois-labpro
cd ois-labpro</code></pre>

        <h3>Step 2: Install Dependencies</h3>
        <pre><code>npm install</code></pre>

        <h3>Step 3: Set Up Environment Variables</h3>
        <p>Create a <code>.env</code> file in the root directory with the following variables:</p>
        <pre><code># Database Configuration
DATABASE_URL=postgresql://username:password@hostname:port/database
PGHOST=hostname
PGUSER=username
PGPASSWORD=password
PGDATABASE=database
PGPORT=port

# OpenAI API Key
OPENAI_API_KEY=your_openai_api_key

# Session Secret
SESSION_SECRET=your_secure_session_secret</code></pre>
        <p>Replace the placeholders with your actual values.</p>

        <h3>Step 4: Database Setup</h3>
        <pre><code># Set up database schema and initial data
npm run db:push</code></pre>
        <p>This will create all necessary tables and relationships in the database.</p>

        <h3>Step 5: Building the Application</h3>
        <pre><code># For production build
npm run build</code></pre>

        <h3>Step 6: Running the Application</h3>
        <h4>Development Mode</h4>
        <pre><code>npm run dev</code></pre>
        <h4>Production Mode</h4>
        <pre><code>npm start</code></pre>
    </div>

    <div class="section">
        <h2>Deployment Options</h2>

        <h3>Option 1: Traditional Server (e.g., VPS)</h3>
        <ol>
            <li>Set up a Node.js environment on your server</li>
            <li>Install PostgreSQL</li>
            <li>Clone the repository and follow steps 2-6</li>
            <li>Use a process manager like PM2:
                <pre><code>npm install -g pm2
pm2 start dist/server/index.js --name "ois-labpro"</code></pre>
            </li>
            <li>Set up Nginx as a reverse proxy:
                <pre><code>server {
    listen 80;
    server_name yourdomain.com;

    location / {
        proxy_pass http://localhost:5000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}</code></pre>
            </li>
            <li>Secure with SSL using Let's Encrypt</li>
        </ol>

        <h3>Option 2: Docker Deployment</h3>
        <ol>
            <li>Create a <code>Dockerfile</code> in the root directory:
                <pre><code>FROM node:20-alpine

WORKDIR /app

COPY package*.json ./
RUN npm install

COPY . .
RUN npm run build

EXPOSE 5000

CMD ["npm", "start"]</code></pre>
            </li>
            <li>Create a <code>docker-compose.yml</code> file:
                <pre><code>version: '3'
services:
  app:
    build: .
    ports:
      - "5000:5000"
    depends_on:
      - db
    environment:
      - DATABASE_URL=postgresql://postgres:postgres@db:5432/ois_labpro
      - PGHOST=db
      - PGUSER=postgres
      - PGPASSWORD=postgres
      - PGDATABASE=ois_labpro
      - PGPORT=5432
      - OPENAI_API_KEY=${OPENAI_API_KEY}
      - SESSION_SECRET=${SESSION_SECRET}
  
  db:
    image: postgres:14
    ports:
      - "5432:5432"
    environment:
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=postgres
      - POSTGRES_DB=ois_labpro
    volumes:
      - postgres_data:/var/lib/postgresql/data

volumes:
  postgres_data:</code></pre>
            </li>
            <li>Run with Docker Compose:
                <pre><code>docker-compose up -d</code></pre>
            </li>
        </ol>

        <h3>Option 3: Cloud Platforms</h3>
        <h4>AWS Elastic Beanstalk</h4>
        <ol>
            <li>Install the EB CLI and initialize your project:
                <pre><code>pip install awsebcli
eb init</code></pre>
            </li>
            <li>Create an environment and deploy:
                <pre><code>eb create ois-labpro-env
eb deploy</code></pre>
            </li>
        </ol>
        <h4>Heroku</h4>
        <ol>
            <li>Install Heroku CLI and login:
                <pre><code>npm install -g heroku
heroku login</code></pre>
            </li>
            <li>Create Heroku app:
                <pre><code>heroku create ois-labpro</code></pre>
            </li>
            <li>Add PostgreSQL:
                <pre><code>heroku addons:create heroku-postgresql:hobby-dev</code></pre>
            </li>
            <li>Set environment variables:
                <pre><code>heroku config:set OPENAI_API_KEY=your_openai_api_key
heroku config:set SESSION_SECRET=your_secure_session_secret</code></pre>
            </li>
            <li>Deploy:
                <pre><code>git push heroku main</code></pre>
            </li>
        </ol>
    </div>

    <div class="section">
        <h2>Access Levels and Authentication</h2>
        
        <h3>SuperAdmin Access</h3>
        <p>SuperAdmin portal provides system-wide control and management:</p>
        <ul>
            <li><strong>Username:</strong> superadmin</li>
            <li><strong>Password:</strong> superadmin123</li>
            <li><strong>Login URL:</strong> /sa-login</li>
        </ul>
        
        <h4>SuperAdmin Capabilities</h4>
        <table>
            <tr>
                <th>Feature</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>Labs Management</td>
                <td>Register and manage multiple laboratory facilities</td>
            </tr>
            <tr>
                <td>Subscription Control</td>
                <td>Manage subscription plans and billing</td>
            </tr>
            <tr>
                <td>System Settings</td>
                <td>Configure global parameters and integration settings</td>
            </tr>
        </table>

        <h3>Admin Access</h3>
        <p>Laboratory administrators can access the admin dashboard with:</p>
        <ul>
            <li><strong>Username:</strong> admin</li>
            <li><strong>Password:</strong> admin123</li>
            <li><strong>Login URL:</strong> /admin</li>
        </ul>
        
        <h4>Admin Capabilities</h4>
        <table>
            <tr>
                <th>Feature</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>Test Management</td>
                <td>Configure and manage diagnostic tests</td>
            </tr>
            <tr>
                <td>User Management</td>
                <td>Manage lab staff and patient accounts</td>
            </tr>
            <tr>
                <td>Booking Administration</td>
                <td>Handle test bookings and update status</td>
            </tr>
            <tr>
                <td>Report Generation</td>
                <td>Create and manage test reports with AI insights</td>
            </tr>
        </table>
    </div>

    <div class="section">
        <h2>API Documentation</h2>
        <p>The OIS LabPro API endpoints are organized into these categories:</p>

        <h3>Authentication</h3>
        <table>
            <tr>
                <th>Endpoint</th>
                <th>Method</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>/api/login</td>
                <td>POST</td>
                <td>Log in with username and password</td>
            </tr>
            <tr>
                <td>/api/register</td>
                <td>POST</td>
                <td>Create a new user account</td>
            </tr>
            <tr>
                <td>/api/user</td>
                <td>GET</td>
                <td>Get current authenticated user</td>
            </tr>
            <tr>
                <td>/api/logout</td>
                <td>POST</td>
                <td>Log out current user</td>
            </tr>
        </table>

        <h3>Test Categories</h3>
        <table>
            <tr>
                <th>Endpoint</th>
                <th>Method</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>/api/test-categories</td>
                <td>GET</td>
                <td>List all test categories</td>
            </tr>
            <tr>
                <td>/api/test-categories/:id</td>
                <td>GET</td>
                <td>Get a specific test category</td>
            </tr>
        </table>

        <h3>Tests</h3>
        <table>
            <tr>
                <th>Endpoint</th>
                <th>Method</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>/api/tests</td>
                <td>GET</td>
                <td>List all tests</td>
            </tr>
            <tr>
                <td>/api/tests/:id</td>
                <td>GET</td>
                <td>Get a specific test</td>
            </tr>
            <tr>
                <td>/api/tests/category/:categoryId</td>
                <td>GET</td>
                <td>Get tests by category</td>
            </tr>
        </table>

        <h3>Bookings</h3>
        <table>
            <tr>
                <th>Endpoint</th>
                <th>Method</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>/api/bookings</td>
                <td>GET</td>
                <td>Get user's bookings</td>
            </tr>
            <tr>
                <td>/api/bookings/:id</td>
                <td>GET</td>
                <td>Get booking details</td>
            </tr>
            <tr>
                <td>/api/bookings</td>
                <td>POST</td>
                <td>Create a new booking</td>
            </tr>
        </table>

        <h3>Reports</h3>
        <table>
            <tr>
                <th>Endpoint</th>
                <th>Method</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>/api/reports</td>
                <td>GET</td>
                <td>Get user's reports</td>
            </tr>
            <tr>
                <td>/api/reports/:id</td>
                <td>GET</td>
                <td>Get report details</td>
            </tr>
            <tr>
                <td>/api/reports/download/:reportId</td>
                <td>GET</td>
                <td>Get report by report ID (public)</td>
            </tr>
            <tr>
                <td>/api/reports/generate-insights</td>
                <td>POST</td>
                <td>Generate AI insights for test results</td>
            </tr>
        </table>

        <h3>Admin Endpoints</h3>
        <table>
            <tr>
                <th>Endpoint</th>
                <th>Method</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>/api/admin/bookings</td>
                <td>GET</td>
                <td>Get all bookings (admin only)</td>
            </tr>
            <tr>
                <td>/api/admin/bookings/:id/status</td>
                <td>PATCH</td>
                <td>Update booking status (admin only)</td>
            </tr>
            <tr>
                <td>/api/admin/reports</td>
                <td>POST</td>
                <td>Create a report for a booking (admin only)</td>
            </tr>
        </table>
    </div>

    <div class="section">
        <h2>System Requirements</h2>
        <ul>
            <li>Minimum 1 CPU core</li>
            <li>1GB RAM</li>
            <li>10GB storage</li>
            <li>PostgreSQL 14+</li>
            <li>Node.js 18+</li>
        </ul>
    </div>

    <div class="section">
        <h2>Troubleshooting</h2>
        <div class="alert">
            <p><strong>Database Connection Issues:</strong></p>
            <ul>
                <li>Ensure the PostgreSQL server is running</li>
                <li>Check the DATABASE_URL and other PG* environment variables</li>
                <li>Verify network connectivity and firewall settings</li>
            </ul>
        </div>

        <div class="alert">
            <p><strong>API Insight Features Not Working:</strong></p>
            <ul>
                <li>Validate the OPENAI_API_KEY is correctly set</li>
                <li>Check OpenAI API quota and limits</li>
            </ul>
        </div>

        <div class="alert">
            <p><strong>Session Management Issues:</strong></p>
            <ul>
                <li>Ensure SESSION_SECRET is properly set</li>
                <li>Check cookie settings in auth.ts for production environments</li>
            </ul>
        </div>
    </div>

    <div class="section">
        <h2>Security Considerations</h2>
        <ol>
            <li>Always use HTTPS in production</li>
            <li>Set secure cookie flags when in production</li>
            <li>Implement rate limiting for API endpoints</li>
            <li>Regularly update dependencies</li>
            <li>Back up the database regularly</li>
        </ol>
    </div>

    <div class="section">
        <h2>Project Structure</h2>
        <h3>Server Files</h3>
        <table>
            <tr>
                <th>File</th>
                <th>Purpose</th>
            </tr>
            <tr>
                <td><code>server/index.ts</code></td>
                <td>Main server entry point, sets up Express app, middleware, and error handling</td>
            </tr>
            <tr>
                <td><code>server/auth.ts</code></td>
                <td>Handles user authentication using Passport.js, session management, and login/register routes</td>
            </tr>
            <tr>
                <td><code>server/db.ts</code></td>
                <td>Database configuration and connection setup using Drizzle ORM with PostgreSQL</td>
            </tr>
            <tr>
                <td><code>server/routes.ts</code></td>
                <td>API route handlers for tests, bookings, reports, and admin functionality</td>
            </tr>
            <tr>
                <td><code>server/storage.ts</code></td>
                <td>Data access layer implementing storage operations for all entities</td>
            </tr>
            <tr>
                <td><code>server/openai.ts</code></td>
                <td>OpenAI integration for generating AI-powered insights from test results</td>
            </tr>
            <tr>
                <td><code>server/vite.ts</code></td>
                <td>Development server configuration for Vite and static file serving</td>
            </tr>
        </table>

        <h3>Client Files</h3>
        <table>
            <tr>
                <th>File</th>
                <th>Purpose</th>
            </tr>
            <tr>
                <td><code>client/src/App.tsx</code></td>
                <td>Root React component with routing setup and providers</td>
            </tr>
            <tr>
                <td><code>client/src/pages/*</code></td>
                <td>React components for different pages (auth, home, tests, reports, admin)</td>
            </tr>
            <tr>
                <td><code>client/src/components/*</code></td>
                <td>Reusable UI components built with shadcn/ui and Tailwind CSS</td>
            </tr>
            <tr>
                <td><code>client/src/hooks/*</code></td>
                <td>Custom React hooks for auth, theme, and API data fetching</td>
            </tr>
            <tr>
                <td><code>client/src/lib/*</code></td>
                <td>Utility functions, API client, and helper code</td>
            </tr>
        </table>

        <h3>Shared Files</h3>
        <table>
            <tr>
                <th>File</th>
                <th>Purpose</th>
            </tr>
            <tr>
                <td><code>shared/schema.ts</code></td>
                <td>Database schema definitions, TypeScript types, and validation using Drizzle and Zod</td>
            </tr>
        </table>

        <h3>Configuration Files</h3>
        <table>
            <tr>
                <th>File</th>
                <th>Purpose</th>
            </tr>
            <tr>
                <td><code>package.json</code></td>
                <td>Project dependencies and npm scripts</td>
            </tr>
            <tr>
                <td><code>tsconfig.json</code></td>
                <td>TypeScript compiler configuration</td>
            </tr>
            <tr>
                <td><code>tailwind.config.ts</code></td>
                <td>Tailwind CSS configuration with shadcn/ui preset</td>
            </tr>
            <tr>
                <td><code>drizzle.config.ts</code></td>
                <td>Drizzle ORM configuration for database migrations</td>
            </tr>
            <tr>
                <td><code>theme.json</code></td>
                <td>UI theme configuration for light and dark modes</td>
            </tr>
            <tr>
                <td><code>.replit</code></td>
                <td>Replit-specific configuration for development and deployment</td>
            </tr>
        </table>
    </div>

    <footer>
        <p>&copy; 2025 OIS LabPro. All rights reserved.</p>
    </footer>
</body>
</html>